/* generated by make_init.pl memalloc.h strpool.h errors.h file.h options.h scan.h codearea.h */

/* includes */
#include "memalloc.h"   			/* before any other include */

#include "init.h"



/* data store for managed object */
typedef struct File_store
{
	void (*delete_func)(File **);	/* delete function pointer, NULL if no auto-delete */
	File data;
} File_store;

/* File: create, destroy, set/clear autodelete */
File * new_File (  char * filename,  char * mode )
{
	File_store *self_store = g_slice_new0( File_store );
	File *self = (File *) OBJREG_DATA_ADDR( self_store );
	
	autodelete_File( self, TRUE );

	struct_File_init( self, filename, mode );

	register_object( (void*) self_store );

	return self;
}

void delete0_File ( File **pself )
{
	if ( *pself )
	{
		File_store *self_store = 
				(File_store *) OBJREG_STORE_ADDR( *pself );
		
		unregister_object( (void*) self_store );

		struct_File_fini( *pself );

		g_slice_free( File_store, self_store );

		*pself = NULL;
	}
}

void delete_File ( File *self )
{
	delete0_File( &self );
}

void autodelete_File ( File *self, BOOL autodelete )
{
	File_store *self_store = 
			(File_store *) OBJREG_STORE_ADDR( self );
	
	self_store->delete_func = autodelete ? delete0_File : NULL;
}